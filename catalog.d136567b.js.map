{"mappings":"YAAA,IAAMA,EAAO,CACXC,YAAaC,SAASC,cAAc,gBACpCC,eAAgBF,SAASC,cAAc,qBACvCE,WAAYH,SAASI,iBAAiB,sBAGnBC,GAA+BP,EAA5CC,YAA4CD,EAA/BI,gBAA+BJ,EAAfK,WA2GxB,GAAGG,UAAUC,IAAI,WAvG9BT,EAAKC,YAAYS,iBAAiB,UAElC,SAA6BC,GAC3BA,EAAEC,iBACFC,WAAa,GACbC,KAAO,EAEP,IAAMC,EAAoBJ,EAAEK,cAApBD,cAIR,GAFAF,WAAaE,EAAcE,MAER,KAAfJ,WACF,QAoDIK,EAAU,mCAGTC,MAAM,GAAuBC,OAFnB,gDAEQ,aAAmBA,OAARF,IAAWG,MAAK,SAAAC,GAClD,IAAKA,EAAUC,GACb,MAAM,IAAIC,MAAMF,EAAUG,QAG5B,OAAOH,EAAUI,M,KAzDAL,MAAK,SAAAM,IAiC1B,SAAkCC,EAAMd,GACtC,IAAMI,EAAU,mCAGhB,OAAOC,MACL,GAAuBC,OAHR,4CAGH,aAA0CA,OAA/BF,EAAQ,yBAAqCE,OAAdN,EAAK,WAAcM,OAALQ,IACpEP,MAAK,SAAAC,GACL,IAAKA,EAAUC,GACb,MAAM,IAAIC,MAAMF,EAAUG,QAG5B,OAAOH,EAAUI,M,KA3CjBG,CAAyBhB,WAAYC,MAAMO,MAAK,SAAAS,GAC9C,IAEMC,EAFSD,EAAKE,QAAQC,MAAM,EAAG,IAEZC,KAAI,SAAAC,GAC3B,IAAMC,EAAQD,EAAMC,MACdC,EAAa,kCAAoDjB,OAAlBe,EAAMG,aACrDC,EAAcJ,EAAMK,aAAaC,UAAU,EAAG,GAC9CC,EAAUP,EAAMQ,GAChBC,EAAST,EAAMU,aASrB,MAAO,CACLT,QACAC,aACAS,YAXkBnB,EAAOA,OACxBoB,QAAO,SAAAC,GACN,GAAIb,EAAMc,UAAUC,SAASF,EAAML,IACjC,OAAOK,C,IAGVd,KAAI,SAAAc,G,OAASA,EAAMpB,I,IAMpBW,cACAK,SACAF,U,IAIJnC,EAAe4C,UAiCrB,SAAuBC,GACrB,IAAMC,EAAgBD,EACnBlB,KAAI,SAAAoB,G,IAAGlB,EAAKkB,EAALlB,MAAOC,EAAUiB,EAAVjB,WAAYS,EAAWQ,EAAXR,YAAaP,EAAWe,EAAXf,YAAaK,EAAMU,EAANV,OAAQF,EAAOY,EAAPZ,QACrDf,EAASmB,EAAY,GAgB3B,MAdiB,0CAGf1B,OAF+BsB,EAAQ,gJAK/BtB,OAHRiB,EAAW,wEAIEjB,OADLgB,EAAM,8BACwBhB,OAAzBO,EAAO,oBAGcP,OAHImB,EAAY,2EAGTnB,OAAPwB,EAAO,kC,IAM5CW,KAAK,IAER,OAAOF,C,CAxDwBG,CAAczB,E,OAoB/C,IACQb,C","sources":["src/js/catalog-search.js"],"sourcesContent":["const refs = {\n  catalogForm: document.querySelector('#search-form'),\n  catalogGallery: document.querySelector('.catalog__gallery'),\n  navigation: document.querySelectorAll('.navigation__link'),\n};\n\nconst { catalogForm, catalogGallery, navigation } = refs;\n\nchangeCurrentNavigation();\n\nrefs.catalogForm.addEventListener('submit', onCatalogFormSubmit);\n\nfunction onCatalogFormSubmit(e) {\n  e.preventDefault();\n  inputValue = '';\n  page = 1;\n\n  const { catalogSearch } = e.currentTarget;\n\n  inputValue = catalogSearch.value;\n\n  if (inputValue === '') {\n    return;\n  }\n\n  fetchMovieGenres().then(genres => {\n    fetchCatalogSearchMovies(inputValue, page).then(data => {\n      const movies = data.results.slice(0, 10);\n\n      const cardsData = movies.map(movie => {\n        const title = movie.title;\n        const posterPath = `https://image.tmdb.org/t/p/w500${movie.poster_path}`;\n        const releaseYear = movie.release_date.substring(0, 4);\n        const movieId = movie.id;\n        const rating = movie.vote_average;\n        const movieGenres = genres.genres\n          .filter(genre => {\n            if (movie.genre_ids.includes(genre.id)) {\n              return genre;\n            }\n          })\n          .map(genre => genre.name);\n\n        return {\n          title,\n          posterPath,\n          movieGenres,\n          releaseYear,\n          rating,\n          movieId,\n        };\n      });\n\n      catalogGallery.innerHTML = createGallery(cardsData);\n    });\n  });\n}\n\nfunction fetchCatalogSearchMovies(name, page) {\n  const API_KEY = 'ec3ca0e4403710b7fc1497b1dbf32c54';\n  const BASE_URL = 'https://api.themoviedb.org/3/search/movie';\n\n  return fetch(\n    `${BASE_URL}?api_key=${API_KEY}&language=en-US&page=${page}&query=${name}`\n  ).then(movieData => {\n    if (!movieData.ok) {\n      throw new Error(movieData.status);\n    }\n\n    return movieData.json();\n  });\n}\n\nfunction fetchMovieGenres() {\n  const API_KEY = 'ec3ca0e4403710b7fc1497b1dbf32c54';\n  const BASE_URL = 'https://api.themoviedb.org/3/genre/movie/list';\n\n  return fetch(`${BASE_URL}?api_key=${API_KEY}`).then(movieData => {\n    if (!movieData.ok) {\n      throw new Error(movieData.status);\n    }\n\n    return movieData.json();\n  });\n}\n\nfunction createGallery(movies) {\n  const generatedHtml = movies\n    .map(({ title, posterPath, movieGenres, releaseYear, rating, movieId }) => {\n      const genres = movieGenres[0];\n\n      const htmlPart = `\n        <div class=\"movie__card\" id=\"${movieId}\">\n        <div class=\"movie__card-poster\" style=\"background-image: linear-gradient(rgba(0,0,0,0),rgba(0, 0, 0, 0), rgba(0,0,0,1)),\n  url(${posterPath});\"></div>\n\n        <div class=\"movie__card-info\">\n          <h3>${title}</h3>\n          <p><span>${genres}</span> | <span>${releaseYear}</span></p>\n        </div>\n\n        <div class=\"movie__card-rating\">${rating}</div>\n      </div> \n        `;\n\n      return htmlPart;\n    })\n    .join('');\n\n  return generatedHtml;\n}\n\nfunction changeCurrentNavigation() {\n  navigation[1].classList.add('current');\n}\n"],"names":["$dffebb1ffafe4b15$var$refs","catalogForm","document","querySelector","catalogGallery","navigation","querySelectorAll","$dffebb1ffafe4b15$var$catalogGallery","classList","add","addEventListener","e","preventDefault","inputValue","page","catalogSearch","currentTarget","value","API_KEY","fetch","concat","then","movieData","ok","Error","status","json","genres","name","$dffebb1ffafe4b15$var$fetchCatalogSearchMovies","data","cardsData","results","slice","map","movie","title","posterPath","poster_path","releaseYear","release_date","substring","movieId","id","rating","vote_average","movieGenres","filter","genre","genre_ids","includes","innerHTML","movies","generatedHtml","param","join","$dffebb1ffafe4b15$var$createGallery"],"version":3,"file":"catalog.d136567b.js.map"}